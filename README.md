# 烟雾与火灾检测系统 - YOLOv8

本项目利用YOLOv8目标检测技术实现烟雾和火灾的自动检测，包含模型训练和图形用户界面两大功能模块。

## 功能特点

- **多种输入源**：支持图片、视频和摄像头实时检测
- **多模型支持**：支持多种YOLOv8模型配置（nano、small、medium等）
- **训练工具**：提供基础和高级模型训练脚本
- **友好界面**：直观的图形用户界面操作体验
- **实时状态**：实时显示FPS、检测结果和模型状态
- **自动扫描模型**：自动扫描weights文件夹中的所有模型文件

## 项目结构

```
├── data/                  # 数据集目录
│   ├── train/             # 训练数据
│   ├── val/               # 验证数据
│   └── test/              # 测试数据
├── weights/               # 模型权重文件存放目录
│   ├── best.pt            # 训练最佳权重
│   └── ...                # 其他模型权重文件
├── results/               # 检测结果保存目录（自动创建）
├── train.py               # 基础模型训练脚本
├── advanced_train.py      # 高级模型训练脚本
├── yolo_detector_gui.py   # 图形用户界面应用
├── utils.py               # 实用工具函数
├── config.py              # 配置文件
├── data.yaml              # 数据集配置
├── requirements.txt       # 项目依赖
└── README.md              # 项目说明文档
```

## 环境配置

1. 安装依赖：
```bash
pip install -r requirements.txt
```

2. 确保数据集结构正确：
```
data/
├── train/
│   ├── images/    # 训练图像
│   └── labels/    # 训练标注
├── val/
│   ├── images/    # 验证图像
│   └── labels/    # 验证标注
└── test/
    ├── images/    # 测试图像
    └── labels/    # 测试标注
```

3. 创建模型存放目录：
```
weights/           # 存放所有模型权重文件的目录
```

## 使用方法

### 图形界面检测

1. 运行GUI应用：
```bash
python yolo_detector_gui.py
```

2. 从界面选择输入源：
   - 图片文件：点击"浏览文件..."按钮或使用 Ctrl+O
   - 视频文件：点击"浏览文件..."按钮或使用 Ctrl+V
   - 摄像头：选择摄像头选项或使用 Ctrl+C

3. 选择模型和调整参数：
   - 从下拉菜单中选择一个模型（程序会自动扫描weights目录下的所有.pt文件）
   - 调整置信度阈值
   - 选择是否保存检测结果

4. 点击"开始检测"按钮开始检测

### 模型训练

#### 基础训练

```bash
python train.py
```

参数可在脚本中调整：
- `model_type`：模型大小 (yolov8n.pt, yolov8s.pt, yolov8m.pt, yolov8l.pt, yolov8x.pt)
- `epochs`：训练轮数
- `batch_size`：批次大小
- `imgsz`：图像尺寸



## 模型管理

训练完成的模型和预训练模型应放置在`weights`目录下：

1. **标准模型**：系统默认支持YOLOv8n、YOLOv8s和YOLOv8m
2. **自定义模型**：将训练好的模型放在`weights`文件夹中，程序启动时会自动扫描并添加到模型选择列表

注意：
- 训练结束后的模型会默认保存在`runs/detect/train*/weights/`目录下
- 请将最终使用的模型手动复制到`weights`目录中
- 只有扩展名为`.pt`的文件会被识别为有效模型


## 性能评估

- **检测速度**：在中等配置GPU上可达到约30 FPS（使用YOLOv8n）
- **检测精度**：mAP（平均精度）值在测试集上可达80%以上
- **误报率**：通过置信度阈值调整，可将误报率控制在较低水平

## 使用提示

- 对于实时检测，推荐使用YOLOv8n模型以获得更高的FPS
- 对于精度要求高的场景，推荐使用YOLOv8s或更大模型
- 可以通过调整置信度阈值（默认0.25）来平衡检出率和误报率
- 可以启用"保存检测结果"选项将检测的图像保存到results目录

## 系统要求

- Python 3.7+
- CUDA支持的NVIDIA GPU（推荐用于训练）
- 至少4GB内存（训练推荐8GB以上） 